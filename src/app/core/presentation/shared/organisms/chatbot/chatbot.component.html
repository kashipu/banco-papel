<!-- Botón flotante -->
@if (!isOpen()) {
  <button
    (click)="toggleChat()"
    class="fixed bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors z-50 flex items-center justify-center"
    aria-label="Abrir chat"
  >
    <svg
      class="w-6 h-6"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
      />
    </svg>
  </button>
}

<!-- Ventana de chat -->
@if (isOpen()) {
  <div
    class="fixed bottom-6 right-6 w-96 h-[600px] bg-white rounded-lg shadow-2xl flex flex-col z-50 border border-gray-200"
  >
    <!-- Header del chat -->
    <div class="flex items-center justify-between p-4 border-b border-gray-200 bg-blue-600 text-white rounded-t-lg">
      <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-green-400 rounded-full"></div>
        <h3 class="font-semibold">Asistente Virtual</h3>
      </div>
      <button
        (click)="toggleChat()"
        class="text-white hover:text-gray-200 focus:outline-none"
        aria-label="Cerrar chat"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>

    <!-- Área de mensajes -->
    <div class="flex-1 overflow-y-auto p-4 bg-gray-50">
      @if (messages().length === 0) {
        <div class="text-center text-gray-500 mt-8">
          <p>¡Hola! ¿En qué puedo ayudarte?</p>
        </div>
      } @else {
        @for (message of messages(); track $index) {
          <app-chat-message [message]="message" />
        }
      }
    </div>

    <!-- Input de mensaje -->
    <app-chat-input (messageSent)="sendMessage($event)" />
  </div>
}

